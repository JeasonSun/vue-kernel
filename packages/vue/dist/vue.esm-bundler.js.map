{"version":3,"file":"vue.esm-bundler.js","sources":["../../shared/src/shapeFlags.ts","../../shared/src/index.ts","../../reactivity/src/effect.ts","../../reactivity/src/baseHandlers.ts","../../reactivity/src/reactive.ts","../../reactivity/src/ref.ts","../../reactivity/src/computed.ts","../../runtime-core/src/vnode.ts","../../runtime-core/src/componentProps.ts","../../runtime-core/src/componentSlots.ts","../../runtime-core/src/component.ts","../../runtime-core/src/renderer.ts","../../runtime-core/src/apiCreateApp.ts","../../runtime-core/src/h.ts"],"sourcesContent":["export const enum ShapeFlags {\n  ELEMENT = 1, // 1 -> 1\n  FUNCTIONAL_COMPONENT = 1 << 1, // 10 -> 2\n  STATEFUL_COMPONENT = 1 << 2, // 100 -> 4\n  TEXT_CHILDREN = 1 << 3,\n  ARRAY_CHILDREN = 1 << 4,\n  SLOTS_CHILDREN = 1 << 5,\n  TELEPORT = 1 << 6,\n  SUSPENSE = 1 << 7,\n  COMPONENT_SHOULD_KEEP_ALIVE = 1 << 8,\n  COMPONENT_KEPT_ALIVE = 1 << 9,\n  COMPONENT = ShapeFlags.STATEFUL_COMPONENT | ShapeFlags.FUNCTIONAL_COMPONENT, // 100|10 -> 110 -> 6\n}\n","export const extend = Object.assign;\n\nexport const isObject = (value) => {\n  return value !== null && typeof value === \"object\";\n};\n\nexport const isString = (value) => typeof value === \"string\";\n\nexport const isFunction = (value) => typeof value === \"function\";\n\nexport const isPromise = (value) =>\n  isObject(value) && isFunction(value.then) && isFunction(value.catch);\n\nexport const hasChanged = (value, newValue) => {\n  return !Object.is(value, newValue);\n};\n\nexport { ShapeFlags } from \"./shapeFlags\";\n","import { extend } from \"@vue-kernel/shared\";\n\n\nconst targetMap = new WeakMap();\nlet activeEffect = void 0;\nlet shouldTrack = false;\n\nexport class ReactiveEffect {\n  deps: any[] = [];\n  active = true;\n  constructor(public fn, public scheduler?) {}\n\n  run() {\n    if (!this.active) {\n      return this.fn();\n    }\n\n    activeEffect = this as any;\n    shouldTrack = true;\n\n    const result = this.fn();\n\n    activeEffect = undefined;\n    shouldTrack = false;\n\n    return result;\n  }\n\n  stop() {\n    if (this.active) {\n      this.deps.forEach((dep) => {\n        dep.delete(this);\n      });\n      this.deps.length = 0;\n      this.active = false;\n    }\n  }\n}\n\nexport function effect(fn, options?) {\n  const _effect = new ReactiveEffect(fn);\n  if (options) {\n    extend(_effect, options);\n  }\n  _effect.run();\n\n  // 返回runner，让用户自行选择调用时机(effectFn)\n  const runner: any = _effect.run.bind(_effect);\n  runner.effect = _effect;\n\n  return runner;\n}\n\nexport function stop(runner) {\n  runner.effect.stop();\n}\n\nexport function track(target, key) {\n  // 如果响应式数据不在effect中，那直接不用收集了，因为收集了也没有触发更新的时机。\n\n  if (!isTracking()) {\n    return;\n  }\n\n  let depsMap = targetMap.get(target);\n  if (!depsMap) {\n    depsMap = new Map();\n    targetMap.set(target, depsMap);\n  }\n\n  let dep = depsMap.get(key);\n  if (!dep) {\n    dep = new Set();\n    depsMap.set(key, dep);\n  }\n  trackEffect(dep);\n}\n\nexport function trigger(target, key) {\n  const depsMap = targetMap.get(target);\n  if (!depsMap) {\n    // 没有被track， 比如 shallowReactive.spec.ts中，shallowReactive，没有收集依赖，但是在修改props.n时候触发更新，找不到depsMap\n    return;\n  }\n  const deps = depsMap.get(key);\n  triggerEffect(deps);\n}\n\nexport function isTracking() {\n  return shouldTrack && activeEffect !== undefined;\n}\n\nexport function trackEffect(dep) {\n  if (!dep.has(activeEffect)) {\n    dep.add(activeEffect);\n    (activeEffect as any).deps.push(dep);\n  }\n}\n\nexport function triggerEffect(deps) {\n  deps.forEach((effect) => {\n    if (effect.scheduler) {\n      effect.scheduler();\n    } else {\n      effect.run();\n    }\n  });\n}\n","\nimport { isObject } from \"@vue-kernel/shared\";\nimport { track, trigger } from \"./effect\";\nimport { reactive, ReactiveFlags, readonly } from \"./reactive\";\n\nconst get = createGetter();\nconst readonlyGet = createGetter(true);\nconst shallowReadonlyGet = createGetter(true, true);\nconst shallowReactiveGet = createGetter(false, true);\n\nexport const mutableHandlers = {\n  get,\n  set: (target, key, newValue, receiver) => {\n    const res = Reflect.set(target, key, newValue, receiver);\n    trigger(target, key);\n    return res;\n  }\n}\n\nexport const readonlyHandlers = {\n  get: readonlyGet,\n  set: (target, key) => {\n    console.warn(`Set operation on key \"${String(key)}\" failed: target is readonly.`)\n    return true;\n  }\n}\n\nexport const shallowReadonlyHandlers = {\n  get: shallowReadonlyGet,\n  set: (target, key) => {\n    console.warn(`Set operation on key \"${String(key)}\" failed: target is readonly.`)\n    return true;\n  }\n}\n\nexport const shallowReactiveHandlers = {\n  get: shallowReactiveGet,\n  set: (target, key, newValue, receiver) => {\n    const res = Reflect.set(target, key, newValue, receiver);\n    trigger(target, key);\n    return res;\n  }\n}\n\nfunction createGetter(isReadonly = false, shallow = false) {\n  return function get(target, key, receiver) {\n    if (key === ReactiveFlags.IS_READONLY) {\n      return isReadonly\n    }\n    if (key === ReactiveFlags.IS_REACTIVE) {\n      return !isReadonly;\n    }\n\n    if (key === ReactiveFlags.IS_SHALLOW){\n      return shallow;\n    }\n\n    const res = Reflect.get(target, key, receiver);\n\n    if (!isReadonly) {\n      track(target, key);\n    }\n\n    if (shallow) {\n      return res;\n    }\n\n    if (isObject(res)) {\n      return isReadonly ? readonly(res) : reactive(res);\n    }\n\n    return res;\n  }\n}","import { mutableHandlers, readonlyHandlers, shallowReactiveHandlers, shallowReadonlyHandlers } from \"./baseHandlers\";\n\nexport const enum ReactiveFlags {\n  IS_REACTIVE = '__v_isReactive',\n  IS_READONLY = '__v_isReadonly',\n  IS_SHALLOW = '__v_isShallow',\n  RAW = '__v_raw',\n}\n\nexport function reactive(raw) {\n  return new Proxy(raw, mutableHandlers)\n}\n\nexport function readonly(raw) {\n  return createReactiveObject(raw, readonlyHandlers);\n}\n\nexport function shallowReadonly(raw) {\n  return createReactiveObject(raw, shallowReadonlyHandlers)\n}\n\nexport function shallowReactive(raw) {\n  return createReactiveObject(raw, shallowReactiveHandlers);\n}\n\nfunction createReactiveObject(raw, baseHandlers) {\n  const proxy = new Proxy(raw, baseHandlers);\n  return proxy;\n}\n\n/**\n * 判断是否是reactive响应式数据\n * isReactive会读取value[ReactiveFlags.IS_REACTIVE]的属性值，触发proxy.get\n * 普通对象因为没有new Proxy，所以返回undefined\n * 被reactive包裹的对象，在new Proxy() getHandlers中设置了IS_REACTIVE = true\n */\nexport function isReactive(value) {\n  return !!value[ReactiveFlags.IS_REACTIVE];\n}\n\nexport function isReadonly(value) {\n  return !!value[ReactiveFlags.IS_READONLY];\n}\n\nexport function isProxy(value) {\n  return isReactive(value) || isReadonly(value);\n}\n\nexport function isShallow(value) {\n  return !!value[ReactiveFlags.IS_SHALLOW];\n}\n\n","import { hasChanged, isObject } from \"@vue-kernel/shared\";\nimport { isTracking, trackEffect, triggerEffect } from \"./effect\";\nimport { isReactive, reactive } from \"./reactive\";\n\nexport class RefImpl {\n  private _rawValue: any;\n  private _value: any;\n  public dep: Set<unknown>; // TODO:定义一下type Dep\n  public __v_isRef = true;\n  constructor(value) {\n    this._rawValue = value;\n    this._value = convert(value);\n    this.dep = new Set();\n  }\n\n  get value() {\n    if (isTracking()) {\n      trackEffect(this.dep);\n    }\n    return this._value;\n  }\n\n  set value(newValue) {\n    if (hasChanged(this._rawValue, newValue)) {\n      this._rawValue = newValue;\n      this._value = convert(newValue);\n      triggerEffect(this.dep);\n    }\n  }\n}\n\nfunction convert(value) {\n  return isObject(value) ? reactive(value) : value;\n}\n\nexport function ref(value) {\n  return new RefImpl(value);\n}\n\nexport function isRef(ref) {\n  return !!ref.__v_isRef;\n}\n\nexport function unRef(ref) {\n  return isRef(ref) ? ref.value : ref;\n}\n\nconst shallowUnwrapHandlers = {\n  get(target, key) {\n    return unRef(Reflect.get(target, key));\n  },\n  set(target, key, value) {\n    // 如果set的value不是一个Ref，那么就代理更改.value\n    if (isRef(target[key]) && !isRef(value)) {\n      return (target[key].value = value);\n    } else {\n      // 如果value是一个Ref，那么直接替换。\n      return Reflect.set(target, key, value);\n    }\n  },\n};\n\nexport function proxyRefs(objectWithRefs) {\n  // TODO: 源码中需要验证是否是isReactive，需要完善reactive\n  // 源码中reactive对象，如果key->value是Ref对象，不需要.value取值\n  // return isReactive(objectWithRefs)\n  //   ? objectWithRefs\n  //   : new Proxy(objectWithRefs, shallowUnwrapHandlers);\n  return new Proxy(objectWithRefs, shallowUnwrapHandlers);\n}\n","import { ReactiveEffect } from \"./effect\";\n\nclass ComputedRefImpl {\n  private _value: any;\n  private _dirty: boolean = true;\n  private effect: ReactiveEffect;\n  constructor(getter) {\n    this.effect = new ReactiveEffect(getter, () => {\n      this._dirty = true;\n    });\n  }\n\n  get value() {\n    if (this._dirty) {\n      this._dirty = false;\n      this._value = this.effect.run();\n    }\n    return this._value;\n  }\n}\n\nexport function computed(getter) {\n  return new ComputedRefImpl(getter);\n}\n","import { isString, ShapeFlags } from \"@vue-kernel/shared\";\n\nexport const createVNode = function (type, props?, children?) {\n  /**\n   * type可能是string，也可能是对象 or Function\n   *\n   */\n\n  // TODO: 暂时处理两种类型 STATEFUL_COMPONENT和 ELEMENT\n  // 需要继续处理 FUNCTIONAL_COMPONENT等\n  const shapeFlag = isString(type)\n    ? ShapeFlags.ELEMENT\n    : ShapeFlags.STATEFUL_COMPONENT;\n\n  const vnode = {\n    el: null,\n    component: null,\n    key: props?.key,\n    type,\n    props: props || {},\n    children,\n    shapeFlag,\n  };\n  return vnode;\n};\n\nexport const Text = Symbol(\"Text\");\nexport const Fragment = Symbol(\"Fragment\");\n\nexport function normalizeVNode(child) {\n  if (typeof child === \"string\" || typeof child === \"number\") {\n    return createVNode(Text, null, String(child));\n  } else {\n    return child;\n  }\n}\n","export function initProps(instance, rawProps) {\n  console.log(\"initProps\");\n  // TODO: initProps需要处理attrs\n  // 如果组件声明了 props 的话， 才可以进入props 属性内\n  // 不然的话需要存储在attrs内\n  // 还要根据isStatefulComponent做额外处理\n  // 具体参见源码： runtime-core/src/componentProps.ts\n  instance.props = rawProps;\n}\n","import { ShapeFlags } from \"@vue-kernel/shared\";\n\nexport function initSlots(instance, children){\n  if(instance.vnode.shapeFlag & ShapeFlags.SLOTS_CHILDREN){\n    // TODO: 处理slots\n  }\n}","import { proxyRefs } from \"@vue-kernel/reactivity\";\nimport {\n  ShapeFlags,\n  isObject,\n  isPromise,\n  isFunction,\n} from \"@vue-kernel/shared\";\nimport { initProps } from \"./componentProps\";\nimport { initSlots } from \"./componentSlots\";\n\n/**\n *\n * @param vnode\n * 对于Component Instance中， type就是包含render setup等的一个对象\n */\nexport function createComponentInstance(vnode): any {\n  const instance = {\n    type: vnode.type,\n    vnode,\n    isMounted: false,\n    setupState: {},\n  };\n\n  return instance;\n}\n\n/**\n * 初始化组件实例\n * @param instance\n */\nexport function setupComponent(instance) {\n  console.log(\"setupComponent\", instance);\n  const { props, children } = instance.vnode;\n  // 1. 处理props\n  initProps(instance, props);\n  // 2. 处理slots\n  initSlots(instance, children);\n\n  const isStateful = isStatefulComponent(instance);\n  // 3. 初始化状态组件\n  // 3.1 运行setup()\n  const setupResult = isStateful ? setupStatefulComponent(instance) : undefined;\n  return setupResult;\n}\n\nexport function isStatefulComponent(instance) {\n  return instance.vnode.shapeFlag & ShapeFlags.STATEFUL_COMPONENT;\n}\nfunction setupStatefulComponent(instance: any) {\n  const Component = instance.type;\n  const { setup } = Component;\n  if (setup) {\n    const setupResult = setup();\n\n    handleSetupResult(instance, setupResult);\n  }\n}\n// TODO: 需要根据setupResult的结果做不同的处理。\nfunction handleSetupResult(instance: any, setupResult: any) {\n  if (isPromise(setupResult)) {\n    // TODO: 如果setupResult是Promise\n  } else if (isFunction(setupResult)) {\n    // 如果setupResult是函数Function\n    instance.render = setupResult;\n  } else if (isObject(setupResult)) {\n    // 如果setupResult是对象\n    // proxyRefs:\n    instance.setupState = proxyRefs(setupResult);\n  }\n  finishComponentSetup(instance);\n}\n\n/**\n * 完成Component Setup\n * 确保instance上面有render函数\n * @param instance \n */\nfunction finishComponentSetup(instance: any) {\n  const Component = instance.type;\n  if(!instance.render){\n    // TODO: 如果compile有值，需要将template编译成render函数\n    \n    instance.render = Component.render;\n  }\n}\n\n","import { Fragment, Text } from \"./vnode\";\nimport { ShapeFlags } from \"@vue-kernel/shared\";\nimport { createComponentInstance, setupComponent } from \"./component\";\n\nexport function render(vnode, container) {\n  patch(vnode, container);\n}\n\nfunction patch(vnode, container) {\n  const { type, shapeFlag } = vnode;\n  // TODO: 暂时只处理statefulComponent & Element & Text\n  switch (type) {\n    case Text:\n      processText(vnode, container);\n      break;\n    case Fragment:\n      processFragment(vnode, container);\n      break;\n    default:\n      if (shapeFlag & ShapeFlags.ELEMENT) {\n        processElement(vnode, container);\n      } else if (shapeFlag & ShapeFlags.COMPONENT) {\n        processComponent(vnode, container);\n      }\n  }\n}\n\nfunction processText(vnode: any, container: any) {\n  throw new Error(\"Function processText not implemented.\");\n}\n\nfunction processFragment(vnode: any, container: any) {\n  throw new Error(\"Function processFragment not implemented.\");\n}\n\nfunction processElement(vnode: any, container: any) {\n  throw new Error(\"Function processElement not implemented.\");\n}\n\n/**\n * 处理组件\n * @param vnode \n * @param container \n */\nfunction processComponent(vnode: any, container: any) {\n  mountComponent(vnode, container);\n}\n/**\n * 初始化组件\n * @param vnode \n * @param container \n */\nfunction mountComponent(initialVnode: any, container: any) {\n  // 1.创建组件实例\n  const instance = (initialVnode.component = createComponentInstance(initialVnode))\n  // 2.setup instance，初始化组件\n  setupComponent(instance);\n\n  // 3. 创建render的副作用\n  setupRenderEffect(instance, initialVnode, container);\n}\n\n// effect里面可以进行收集依赖，初次渲染就是需要收集所有的响应式依赖\nfunction setupRenderEffect(instance: any, initialVnode: any, container: any) {\n  instance.render();\n}\n\n","import { render } from \"./renderer\";\nimport { createVNode } from \"./vnode\";\nexport function createAppAPI(render) {}\n\nexport function createApp(rootComponent) {\n  const app = {\n    _component: rootComponent,\n    mount(rootContainer) {\n      console.info(\"基于根组件创建 vnode\");\n      const vnode = createVNode(rootComponent);\n      console.info(\"调用 render(), 基于vnode进行开箱\");\n      render(vnode, rootContainer);\n    },\n  };\n  return app;\n}\n","import { createVNode } from \"./vnode\";\n\nexport const h = (type, props, children) => {\n  return createVNode(type, props, children);\n};\n"],"names":[],"mappings":"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"}